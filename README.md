# Telegram Weather Bot

## Описание
Telegram-бот для получения текущей погоды в указанном городе. Бот поддерживает установку любимого города и предоставляет REST API для просмотра истории запросов.

## Возможности
- Получение текущей погоды: `/weather <город>` или `/weather` для любимого города.
- Установка любимого города: `/setcity <город>`.
- Получение установленного города: `/getcity`.
- Просмотр истории запросов через REST API.
- Ежедневные уведомления о погоде (опционально).
- Помощь: `/help`.

## Стек технологий

- **Python** — основной язык разработки.
- **python-telegram-bot** — библиотека для взаимодействия с API Telegram.
- **httpx** — для асинхронных HTTP-запросов к API OpenWeatherMap.
- **FastAPI** — REST API для просмотра логов запросов пользователей.
- **SQLAlchemy** — ORM для взаимодействия с базой данных PostgreSQL.
- **aiocache** — in-memory кэш для временного хранения данных о погоде (10 минут).
- **PostgreSQL** — база данных для хранения истории запросов и настроек пользователей.
- **dotenv** — загрузка переменных окружения из `.env` файла.
- **logging** — для записи логов активности и ошибок.

## Установка и запуск

1. Клонируйте репозиторий
   ```bash
   git clone https://github.com/Dontgoingforyou/weather_bot.git
   cd weather_bot

2. Установите зависимости
    ```bash
   poetry install
   
3. Настройте переменные окружения в файле .env
    ```bash
   TELEGRAM_TOKEN=<ваш_токен>
   OPENWEATHERMAP_API_KEY=<ваш_ключ>
   DATABASE_URL=postgresql://user:password@localhost/weather_bot_db

4. Запустите скрипты для создания базы данных и таблиц
   ```bash
   python scripts.py
   
5. Запустите бота
   ```bash
   python bot.py
   
6. (Опционально) Запустите сервер FastAPI для доступа к истории запросов
   ```bash
   uvicorn api:app --reload
   
## Использование
После запуска бота отправьте команду `/start` в Telegram, чтобы начать. Используйте команды `/weather`, `/setcity`, `/getcity` для работы с ботом. Чтобы получить историю запросов, отправляйте GET-запросы к серверу FastAPI.